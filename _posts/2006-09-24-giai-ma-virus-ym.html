---
author: ttt_conan
title: 'Giải mã virus YM'
date: 2006-09-24T15:57:58+07:00
---
<div style="text-align: center;"><img src="images/1159113478-sc-40.jpg" ></div><br><p><font color="#d0d0d0" size="2" face="Arial, Helvetica, sans-serif">Sau khi nhận hàng loạt các đường link đến các trang web chứa virus từ bạn bè qua Yahoo Messenger, mình bắt đầu tự hỏi con virus ấy có gì ghê gớm mà nhiều người dính nhỉ? Và mình thử tìm hiểu về con virus ấy.</font></p>
<p><font color="#d0d0d0" size="2" face="Arial, Helvetica, sans-serif">Trong quá trình tìm hiểu mình đã nhận ra một điều rằng, con virus ấy không phải được tạo ra để phá hoại mà được tạo ra như một công cụ. Công cụ giúp người ta được nổi tiếng và ngưỡng mộ. Nếu như các tay hacker nước ngoài viết virus vì mục đích kinh tế (đánh cắp thông tin cá nhân, tài khoản ngân hàng...) thì các tay viết virus VN chỉ muốn chứng tỏ khả năng của mình để mọi người biết đến và ngưỡng mộ. Chẳng phải vậy sao khi mà kẻ viết virus không hề cố gắng giấu tung tích của mình và đã bị BKIS sờ chỉ sau một ngày mã nguồn của gaixinh (xrobots) được phân tích. Sau đó kẻ viết virus lại đưa mã nguồn của nó lên diễn đàn hacker Việt Nam - HVA để mọi người trầm trồ và học hỏi. Người viết virus nói rằng mình chỉ muốn thử nghiệm! Tôi nghĩ đó chỉ là một cách ngụy biện. (Và tôi cho rằng không có gì tồi tệ bằng việc thử nghiệm Virus.). Nhờ báo chí mà tính chất nghiêm trọng của virus được tâng bốc lên gấp bội (thực ra là đâu phải tay phóng viên nào cũng rành về IT đâu). Bên cạnh đó cũng có vài vụ tranh cãi ầm ỹ trên các diễn đàn tin học về việc giải mã con virus. Ai cũng muốn chứng tỏ rằng mình hiểu biết và đã giải mã (dịch ngược) thành công con virus (lại là fame & reputation?). Hàng loạt những con virus mới đây (nhut.be; viet8x; audition...) thực chất cũng được tạo ra với mục đích tương tự. Chúng không có mã độc để phá hoại và chúng đều dựa vào mã nguồn của xrobots đã được công bố trên mạng. Thật đáng buồn! Những kẻ ấy sao không giỏi mà tạo ra cho riêng mình một con virus mà cứ bắt chước mã nguồn của người khác. Quả thật, những hacker thật sự giỏi ở VN chỉ đếm được trên đầu ngón tay.</font></p>
<p><font color="#d0d0d0" size="2" face="Arial, Helvetica, sans-serif">Bây giờ nói tới khía cạnh kỹ thuật. Khi đọc các bài viết trong HVA, tôi biết được một điều rằng xRobot (và tất cả các virus VN lây lan qua YM gần đây) đều được viết bằng Autoit - một công cụ script loader giúp giảm tải các công việc cấp thấp bên dưới hệ thống windows để lập trình viên tập trung vào giao diện và các thao tác thực tế hơn. Ngay cả những amateur như tôi chỉ cần biết một số hàm và cú pháp của Autoit, tôi cũng có thể viết được một đoạn chương trình làm thay đổi registry hay thực thi bất cứ lệnh nào có trong windows (thông qua việc giả lập bàn phím của người dùng). Điều thú vị là nếu chương trình virus không được mã hóa và đặt passphrase, bất cứ ai cũng có thể dịch ngược con virus về mã nguồn chương trình ban đầu. Và tôi đã dịch ngược thành công một con gần đây.</font></p>
<p><font color="#d0d0d0" size="2" face="Arial, Helvetica, sans-serif">Về con virus, thực chất nó không hề lây vào trong Yahoo Messenger (như một số báo chí từng nói). Nó chạy như một ứng dụng không có giao diện, tìm cửa sổ Yahoo Messenger, gửi vài tổ hợp phím để thay đổi Status Message và gửi một mass message cho tất cả nick trong buddies list.</font></p>
<p><font color="#d0d0d0" size="2" face="Arial, Helvetica, sans-serif">Để dễ hình dung, tôi tóm tắt cách mà virus tương tác với YM như sau: <br />
</font><font color="#d0d0d0" size="2" face="Arial, Helvetica, sans-serif">- Kiểm tra xem cửa sổ YM có đang chạy không. <br />
- Chuyển con trỏ đến cửa sổ YM (để các phím tắt chỉ tác động lên cửa sổ này) <br />
- Chép dòng thông báo với đường link vào clipboard</font><font color="#d0d0d0" size="2" face="Arial, Helvetica, sans-serif"> <br />
- Gửi tổ hợp phím Alt-M (vào menu Messenger) -> phím U -> phím N -> Ctrl-V (paste nội dung trong clipboard) -> Enter -> Enter: thao tác này để thay đổi status message <br />
- Gửi tổ hợp phím Ctrl-M (send message) -> phím mũi tên xuống (Down) -> Giữ Ctrl-Shift -> phím Home -> buông Ctrl-Shift -> Enter -> Ctrl-V: thao tác này để gửi đường link cho mọi người trong list</font></p>
<p><font color="#d0d0d0" size="2" face="Arial, Helvetica, sans-serif">Ngoài ra còn một số dòng lệnh để thay đổi registry để windows chạy nó mỗi lúc khởi động và vô hiệu việc edit registry từ user... Tất cả những thao tác này đều được Autoit hỗ trợ sẵn cú pháp</font></p>
<p><font color="#d0d0d0" size="2" face="Arial, Helvetica, sans-serif">Như vậy có thể thấy, nguyên lý của con virus không có gì cao siêu, ngay cả những người bình thường cũng có thể hiểu (thậm chí nếu có mã nguồn của nó có thể compile ra vài con bằng Autoit). Lý do mà virus lây lan nhanh chóng là ở ý thức của nhiều người dùng VN (điều này tôi chỉ khẳng định lại) cộng với hạn chế về kiến thức tin học, tiếng Anh của họ.</font></p>
<p><font color="#d0d0d0" size="2" face="Arial, Helvetica, sans-serif">Tóm lại, virus vi tính giống như virus gây bệnh của con người vậy. Dù là virus điện tử hay sinh vật, chúng đều gây cho con người những phiền toái và đau khổ. Khi nào còn con người chúng ta thì khi đó vẫn còn có virus. Vì vậy chúng ta không còn cách nào khác là sống chung với chúng và tự phòng bệnh hơn chữa bệnh. Internet như là một xã hội ảo, có nhiều cái tốt và cũng không ít cái xấu. Và cái xấu dường như ngày càng nhiều ra và tinh vi. Mọi cư dân mạng đều cần phải thường xuyên cập nhật mình và phương tiện của mình (computer) để biết cách phòng và chống các mối đe dọa từ internet.</font></p>
<p><font color="#d0d0d0" size="2" face="Arial, Helvetica, sans-serif">Tôi khinh bỉ các tay viết virus copy kia. Thật chẳng hay ho gì việc phát tán những con virus sao chép mã nguồn của người khác. Nghiên cứu virus cũng là một cách để nâng cao kiến thức cũa mình, nhưng tìm cách tạo và phát tán chúng thì rõ ràng họ thật ích kỷ và vô trách nhiệm.</font></p>